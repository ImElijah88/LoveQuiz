<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘ä»¬çš„å…±åŒæ—…ç¨‹ï¼šä¸€ä»½å…³ç³»é—®å·</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Dancing Script for a handwritten feel (still used for questions) -->
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Custom font for a more modern look, and romantic color palette */
        body {
            font-family: "Inter", sans-serif;
            background-color: #fcf4f8; /* Very light pink/blush background */
            color: #4a2f4c; /* Darker plum/wine text */
        }
        /* Style for textareas to ensure good readability */
        textarea {
            resize: vertical; /* Allow vertical resizing manually, but JS will auto-grow */
            min-height: 80px; /* Minimum height for display */
            padding: 10px;
            border-radius: 8px; /* Rounded corners for textareas */
            border: 1px solid #e0b4c7; /* Softer border */
            background-color: #fcebeb; /* Lighter pink for input */
            transition: all 0.2s ease-in-out;
            line-height: 1.6; /* Slightly more space for readability */
            overflow: hidden; /* Hide scrollbar, as content will expand */
        }
        textarea:focus {
            outline: none;
            border-color: #d18aab; /* Romantic pink focus border */
            box-shadow: 0 0 0 3px rgba(209, 138, 171, 0.2); /* Soft pink shadow on focus */
        }
        /* Style for the initial pre-filled answer text */
        textarea.initial-answer {
            color: #94a3b8; /* Lighter grey for pre-filled text */
            font-style: italic;
        }

        /* Overriding default Tailwind colors for a romantic theme */
        .text-blue-800 { /* Header color */
            color: #8c2f5d; /* Deeper rose/plum for header */
        }
        .text-gray-600, .text-gray-700 { /* Body text color */
            color: #5d4a66; /* Softer, slightly purplish gray */
        }
        .bg-blue-50, .border-blue-200 { /* Instructions/Footer background/border */
            background-color: #f8eaf0; /* Light rose blush */
            border-color: #e6cee0; /* Softer border */
        }
        .text-blue-700 { /* Section headers color */
            color: #7b4f7f; /* Plum-purple for section headers */
        }
        .bg-gray-50 { /* Question card background */
            background-color: #fcf6f9; /* Very light rose for question cards */
            border-color: #f2e2ec; /* Subtle border */
        }
        .text-gray-800 { /* Question label color */
            color: #6a4f70; /* Slightly darker plum for labels */
        }
        /* Button styling for a romantic look */
        .btn-primary {
            @apply px-6 py-3 font-semibold rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105;
            background-color: #c75b8a; /* Romantic pink/rose */
            color: white;
            box-shadow: 0 4px 6px rgba(199, 91, 138, 0.2);
        }
        .btn-primary:hover {
            background-color: #b34a79; /* Darker pink on hover */
        }
        /* Specific styling for the PDF download button */
        .btn-pdf {
             background-color: #75a76c; /* Softer green */
             box-shadow: 0 4px 6px rgba(117, 167, 108, 0.2);
        }
        .btn-pdf:hover {
            background-color: #629059; /* Darker green on hover */
        }
        /* Styling for the new email answers text area in the custom alert */
        #emailAnswersTextarea {
            width: 100%;
            height: 150px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #e0b4c7;
            background-color: #fcebeb;
            font-family: "Inter", sans-serif;
            color: #4a2f4c;
            resize: vertical;
            margin-top: 10px;
            margin-bottom: 15px; /* Added space below textarea */
        }
        input[type="email"] {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #e0b4c7;
            background-color: #fcebeb;
            transition: all 0.2s ease-in-out;
            margin-top: 5px;
        }
        input[type="email"]:focus {
            outline: none;
            border-color: #d18aab;
            box-shadow: 0 0 0 3px rgba(209, 138, 171, 0.2);
        }

        /* Specific print styles */
        @media print {
            body {
                background-color: #fff;
                color: #000;
            }
            /* Elements with 'no-print' class will be hidden in print */
            .no-print {
                display: none !important;
            }
            textarea {
                border: 1px dashed #94a3b8; /* Dashed border for print to indicate fillable area */
                background-color: #fff;
                min-height: 120px; /* More space for writing on print */
                height: auto !important; /* Ensure height adapts for print */
                overflow: hidden !important; /* No scrollbars on print */
                padding: 5px;
            }
            /* Ensure the initial-answer styling is removed for printing if no actual user input */
            textarea.initial-answer {
                color: #000 !important; /* Ensure black text for print */
                font-style: normal !important; /* Remove italic for print */
            }

            /* Adjust margins for printing */
            .p-4, .sm:p-6, .md:p-8 {
                padding: 1rem !important;
            }
            .max-w-4xl {
                max-width: 100% !important;
                width: 100% !important;
                box-shadow: none !important;
                border: none !important;
            }
            .rounded-2xl {
                border-radius: 0 !important;
            }
            /* Remove shadows and borders for cleaner print */
            .shadow-xl, .shadow-sm, .border {
                box-shadow: none !important;
                border: none !important;
            }
            .bg-white, .bg-blue-50, .bg-gray-50 {
                background-color: #fff !important;
            }
            /* Ensure all details content is always open when printing */
            details[open] summary ~ * { /* General rule for all details content */
                display: block !important;
            }
            details summary::after { /* Hide plus/minus on print for all details */
                 content: none !important;
            }
            /* Specific rule to ensure the main legal details section expands on print */
            #legalTermsDetails summary ~ * {
                display: block !important;
            }
            /* Ensure signature box is visible if it was displayed on screen */
            .signature-box.hidden { /* Override the 'hidden' class only for printing */
                display: block !important;
            }
        }
        /* Custom modal overlay for confirmation */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000; /* Higher than other elements */
        }
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            max-width: 600px; /* Smaller modal width */
            width: 90%; /* Responsive width */
            max-height: 90vh; /* Limit height to viewport height */
            overflow-y: auto; /* Allow scrolling within the modal if content exceeds max-height */
            text-align: center;
            font-family: "Inter", sans-serif;
            color: #334155;
            position: relative; /* For absolute positioning of close button */
            display: flex; /* Flex for content alignment */
            flex-direction: column; /* Stack content vertically */
        }
        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #9ca3af; /* Gray color for the X */
            padding: 5px;
            line-height: 1; /* Adjust line height for better centering of X */
        }
        .modal-close-btn:hover {
            color: #4a2f4c; /* Darker color on hover */
        }

        /* Heart-shaped button specific styles */
        .btn-heart {
            background-color: #3b82f6; /* Blue background */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px; /* Space between text and heart */
        }
        .btn-heart:hover {
            background-color: #2563eb; /* Darker blue on hover */
        }
        .btn-heart .heart-icon {
            font-size: 1.25rem; /* Size of the heart emoji */
        }

        /* Custom list styling for the guide section */
        .romantic-list {
            list-style: none; /* Remove default bullet points */
            padding-left: 0;
            text-align: left; /* Align text to the left */
        }
        .romantic-list li {
            position: relative;
            padding-left: 1.8rem; /* Space for the heart icon */
            margin-bottom: 0.75rem; /* Space between list items */
        }
        .romantic-list li::before {
            content: 'â¤ï¸'; /* Heart emoji as bullet */
            position: absolute;
            left: 0;
            top: 0.1rem; /* Adjust vertical alignment */
            color: #d18aab; /* Romantic pink color for hearts */
            font-size: 1.1rem; /* Size of the heart icon */
        }
        /* Style for the handwritten section - now Comic Sans */
        .handwritten-guide-title {
            font-family: 'Comic Sans MS', cursive; /* Changed to Comic Sans */
            font-weight: 700; /* Bold for title */
            font-size: 2.5rem; /* Larger font size for title */
            color: #8c2f5d; /* Deeper rose/plum */
        }
        .handwritten-guide-text {
            font-family: 'Comic Sans MS', cursive; /* Changed to Comic Sans */
            font-weight: 400; /* Regular weight for text */
            font-size: 1.25rem; /* Slightly larger for readability */
            color: #5d4a66; /* Softer, slightly purplish gray */
            line-height: 1.8; /* More space for readability */
        }
        /* Style for the handwritten questions */
        .handwritten-question-label {
            font-family: 'Dancing Script', cursive;
            font-weight: 700; /* Bold for questions */
            font-size: 1.5rem; /* Larger font size for readability */
            color: #7b4f7f; /* Plum-purple */
            line-height: 1.5;
        }

        /* Styling for the details/summary element */
        details {
            background-color: #f8eaf0; /* Light rose blush */
            border: 1px solid #e6cee0; /* Softer border */
            border-radius: 0.75rem; /* Rounded corners */
            padding: 1rem;
            margin-bottom: 2rem; /* Space below the guide box */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05); /* Subtle shadow */
        }
        summary {
            cursor: pointer;
            display: flex; /* Allow content to align */
            flex-wrap: wrap; /* Allow content to wrap if needed */
            align-items: center; /* Vertically center content */
            font-family: 'Comic Sans MS', cursive; /* Apply Comic Sans to summary */
            font-weight: 700; /* Bold for summary text */
            font-size: 1.5rem; /* Match the original title size, adjust as needed */
            color: #8c2f5d; /* Deeper rose/plum */
            padding: 0.5rem 0; /* Padding for click area */
            line-height: 1.2; /* Adjust line height for summary text */
            user-select: none; /* Prevent text selection on click */
        }
        summary::-webkit-details-marker {
            display: none; /* Hide default arrow */
        }
        summary::after {
            content: '+'; /* Custom plus icon */
            margin-left: auto; /* Push to the right */
            font-size: 2rem;
            color: #d18aab;
            transition: transform 0.2s;
        }
        details[open] summary::after {
            content: '-'; /* Change to minus when open */
            transform: rotate(0deg);
        }
        details[open] summary {
            border-bottom: 1px dashed #e0b4c7;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
        }
        /* Ensure specific list styles within details */
        details .romantic-list li {
            font-family: 'Comic Sans MS', cursive;
            font-size: 1.15rem; /* Slightly smaller than summary but larger than body */
            color: #5d4a66;
        }
        /* Adjustments for text within summary */
        summary .intro-text-summary {
            font-size: 1.15rem; /* Smaller font for introductory text in summary */
            font-weight: 400; /* Regular weight */
            color: #5d4a66; /* Softer text color */
            margin-left: 0.5rem; /* Small margin after title */
        }
        summary .more-instructions-text {
            display: block; /* Force this onto a new line for better readability */
            width: 100%; /* Take full width */
            font-size: 1rem; /* Even smaller, subtle hint */
            color: #a0a0a0; /* Lighter color */
            margin-top: 0.5rem; /* Space above */
        }
        /* Style for the new introduction text */
        .intro-section-text {
            font-family: 'Dancing Script', cursive;
            font-weight: 700; /* Bold for the introductory text */
            font-size: 1.8rem; /* Large font size for impact */
            color: #7b4f7f; /* Plum-purple to match questions */
            line-height: 1.5;
            text-align: center;
            margin-top: 2rem; /* Space above it */
            margin-bottom: 2rem; /* Space below it */
            padding: 0 1rem; /* Padding on sides for smaller screens */
            position: relative; /* For absolute positioning of optional emoji/sticker */
        }
        .intro-section-text .animated-sticker {
            position: absolute;
            right: 10%; /* Adjust as needed */
            top: 50%;
            transform: translateY(-50%);
            width: 60px; /* Adjust size as needed */
            height: 60px;
            border-radius: 50%; /* Make it round */
            object-fit: cover;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        @media (max-width: 768px) {
            .intro-section-text .animated-sticker {
                position: static; /* Remove absolute positioning on small screens */
                display: block;
                margin: 1rem auto; /* Center it */
            }
        }


        /* Styles for the Legal Terms Section now open by default */
        .final-legal-section {
            background-color: #f8eaf0; /* Light rose blush */
            border: 1px solid #e6cee0; /* Softer border */
            border-radius: 0.75rem; /* Rounded corners */
            padding: 1.5rem; /* Slightly more padding */
            margin-top: 3rem; /* More space before it */
            margin-bottom: 2rem; /* Space after it, before footer */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05); /* Subtle shadow */
        }
        .final-legal-section h2 { /* Targeting the main title of this section */
            font-family: 'Comic Sans MS', cursive;
            font-weight: 700;
            font-size: 2.2rem; /* Adjusted for an open section */
            color: #8c2f5d;
            text-align: center;
            margin-bottom: 1.5rem;
        }
        .final-legal-section h3 {
            font-family: "Inter", sans-serif;
            font-weight: 700;
            color: #4a2f4c;
            margin-top: 1.5rem; /* More space for subheadings */
            margin-bottom: 0.75rem;
            font-size: 1.15rem; /* Slightly smaller for subheadings */
        }
        .final-legal-section p, .final-legal-section ul {
            font-family: "Inter", sans-serif;
            font-size: 0.95rem; /* Slightly larger text for better readability */
            color: #5d4a66;
            line-height: 1.6;
        }
        .final-legal-section ul {
            padding-left: 1.8rem; /* Indent list items */
        }
        .final-legal-section .consent-checkbox-container {
            margin-top: 2rem; /* More space above checkbox */
            text-align: center;
        }
        .final-legal-section .consent-checkbox-container label {
            font-family: "Inter", sans-serif;
            font-size: 1.05rem; /* Slightly larger label */
            font-weight: 600;
            color: #334155;
            display: flex; /* Align checkbox and text */
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .final-legal-section .consent-checkbox-container input[type="checkbox"] {
            margin-right: 0.75rem; /* Space between checkbox and text */
        }

        /* Signature Box Styling */
        .signature-box {
            background-color: #fcf6f9;
            border: 1px dashed #d18aab;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-top: 2rem;
            text-align: center;
            transition: all 0.3s ease-in-out;
        }
        .signature-box label {
            font-family: "Inter", sans-serif;
            font-weight: 600;
            color: #4a2f4c;
            margin-bottom: 0.75rem;
            display: block;
        }
        .signature-box input[type="text"] {
            font-family: "Inter", sans-serif;
            text-align: center;
            width: 80%;
            max-width: 300px;
            padding: 0.5rem;
            border: 1px solid #e0b4c7;
            border-radius: 0.375rem;
            background-color: #fcebeb;
            color: #4a2f4c;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }
        .signature-box .acknowledgement-text {
            font-family: "Inter", sans-serif;
            font-size: 0.9rem;
            color: #6a4f70;
            margin-top: 0.75rem;
        }
        .dancing-script-signature {
            font-family: 'Dancing Script', cursive;
            font-weight: 700;
            font-size: 2.5rem;
            color: #8c2f5d;
            margin-top: 1.5rem;
            border-top: 2px solid #d18aab;
            padding-top: 0.5rem;
            display: inline-block;
            line-height: 1;
        }

        /* Styling for the main legal details summary and its content */
        .legal-terms-details {
            background-color: #f8eaf0;
            border: 1px solid #e6cee0;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-top: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        .legal-terms-details summary {
            font-family: 'Comic Sans MS', cursive;
            font-weight: 700;
            font-size: 1.5rem;
            color: #8c2f5d;
            padding: 0.5rem 0;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        .legal-terms-details summary::after {
            content: '+';
            margin-left: auto;
            font-size: 2rem;
            color: #d18aab;
            transition: transform 0.2s;
        }
        details[open] summary::after {
            content: '-';
            transform: rotate(0deg);
        }
        details[open] summary {
            border-bottom: 1px dashed #e0b4c7;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
        }
        .legal-terms-details .legal-content-area h3 {
            font-family: "Inter", sans-serif;
            font-weight: 700;
            color: #4a2f4c;
            margin-top: 1rem;
            font-size: 1.15rem;
        }
        .legal-terms-details .legal-content-area p, .legal-terms-details .legal-content-area ul {
            font-family: "Inter", sans-serif;
            font-size: 0.9rem;
            color: #5d4a66;
            line-height: 1.6;
            text-align: left;
        }
        .legal-terms-details .legal-content-area ul {
            padding-left: 1.5rem;
        }

        /* Styling for the new email input container at the bottom */
        .email-input-bottom-container {
            padding: 1.5rem; /* Consistent padding with other sections */
            background-color: #f8eaf0; /* Light rose blush background */
            border-radius: 0.75rem; /* Rounded corners */
            border: 1px solid #e6cee0; /* Softer border */
            margin-top: 2rem; /* Space from the section above */
            margin-bottom: 2rem; /* Space before the footer */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05); /* Subtle shadow */
            text-align: center; /* Center content */
        }
        .email-input-bottom-container label {
            font-family: "Inter", sans-serif;
            font-weight: 600;
            color: #4a2f4c;
            margin-bottom: 1rem; /* More space below label */
            display: block; /* Ensure label takes full width */
            font-size: 1.1rem; /* Slightly larger font for prominence */
        }
        .email-input-bottom-container input[type="email"] {
            width: 80%; /* Adjusted width for centering */
            max-width: 400px; /* Max width for larger screens */
            margin: 0 auto; /* Center the input field */
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #e0b4c7;
            background-color: #fcebeb;
            transition: all 0.2s ease-in-out;
        }
        input[type="email"]:focus {
            outline: none;
            border-color: #d18aab;
            box-shadow: 0 0 0 3px rgba(209, 138, 171, 0.2);
        }

        /* Style for the new direct submission box (Formspree) */
        .direct-submit-box {
            background-color: #fffbeb; /* Very light yellow */
            color: #854d0c; /* Darker yellow/orange text */
            border: 1px solid #fde68a; /* Soft yellow border */
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-top: 3rem; /* Space above */
            margin-bottom: 1rem; /* Reduced margin to make space for mailto */
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        .direct-submit-box .message-text {
            font-family: "Inter", sans-serif;
            font-size: 1.15rem;
            font-weight: 500;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }
        .direct-submit-box .btn-primary { /* Style the button within the yellow box */
            background-color: #f59e0b; /* A brighter yellow/orange for the button */
            color: white;
            box-shadow: 0 4px 6px rgba(245, 158, 11, 0.2);
        }
        .direct-submit-box .btn-primary:hover {
            background-color: #d97706; /* Darker on hover */
        }

        /* NEW: Style for the Mailto submission box */
        .mailto-submit-box {
            background-color: #e6f7ff; /* Light blue */
            color: #0c4a6e; /* Darker blue text */
            border: 1px solid #a3d9f7; /* Soft blue border */
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-top: 1.5rem; /* Space from Formspree box */
            margin-bottom: 2rem; /* Space below */
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        .mailto-submit-box .message-text {
            font-family: "Inter", sans-serif;
            font-size: 1.05rem; /* Slightly smaller text for this option */
            line-height: 1.5;
            margin-bottom: 1.5rem;
        }
        .mailto-submit-box .btn-primary { /* Mailto button style */
            background-color: #007bff; /* Standard blue */
            color: white;
            box-shadow: 0 4px 6px rgba(0, 123, 255, 0.2);
        }
        .mailto-submit-box .btn-primary:hover {
            background-color: #0056b3; /* Darker blue on hover */
        }

        /* Keyframes for the pulse animation */
        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        .recollection-animation-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 3rem 0; /* Spacing above and below */
            min-height: 100px; /* Ensure space for the animation */
            position: relative;
        }
        .recollection-animation-container .heart-pulse {
            font-size: 5rem; /* Large heart */
            color: #e04a7a; /* Vibrant pink heart */
            animation: pulse 2s infinite ease-in-out; /* Apply pulse animation */
            text-shadow: 0 0 15px rgba(224, 74, 122, 0.5); /* Soft glow */
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8 flex items-center justify-center min-h-screen">
    <div class="max-w-4xl w-full bg-white rounded-2xl shadow-xl p-6 sm:p-8 md:p-10 border border-gray-200">
        <!-- Header Section -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-blue-800 mb-2">
                æˆ‘ä»¬çš„å…±åŒæ—…ç¨‹ï¼šä¸€ä»½å…³ç³»é—®å· â¤ï¸
            </h1>
            <p class="text-gray-600 text-lg sm:text-xl">
                ä¸€ä¸ªæ¢ç´¢æˆ‘ä»¬å¯¹é•¿æœŸå…³ç³»é‡è¦æ–¹é¢çš„çœ‹æ³•çš„ç©ºé—´ã€‚
            </p>
        </header>

        <!-- Instructions Section - now an expandable <details> tag -->
        <details id="gentleGuideDetails">
            <summary>
                <h2 class="handwritten-guide-title mb-0 inline">ä¸€ä»½æ¸©å’Œçš„æŒ‡å—:</h2>
                <span class="handwritten-guide-text more-instructions-text">
                    ç‚¹å‡»æ­¤å¤„è·å–æ›´å¤šè¯´æ˜...
                </span>
            </summary>
            <!-- Moved introductory paragraph inside the details content -->
            <p class="handwritten-guide-text mt-4">
                è¯·èŠ±æ—¶é—´è®¤çœŸæ€è€ƒæ¯ä¸ªé—®é¢˜ï¼Œå¹¶åˆ†äº«æ‚¨çš„æ·±æ€ç†Ÿè™‘çš„è§è§£ã€‚æ²¡æœ‰æ­£ç¡®æˆ–é”™è¯¯çš„ç­”æ¡ˆï¼Œåªæœ‰å¸®åŠ©æˆ‘ä»¬æ›´æ·±å…¥åœ°ç†è§£å½¼æ­¤çš„è§‚ç‚¹ï¼ŒåŒæ—¶æˆ‘ä»¬å±•æœ›æˆ‘ä»¬ç¾å¥½çš„æœªæ¥ã€‚æ‚¨çš„çœŸè¯šæƒ³æ³•å¼¥è¶³çè´µã€‚
            </p>
            <ul class="romantic-list handwritten-guide-text mt-4">
                <li>æ•°å­—åŒ–å¡«å†™ï¼šåœ¨ä»»ä½•ç½‘é¡µæµè§ˆå™¨ä¸­æ‰“å¼€æ­¤æ–‡ä»¶ã€‚ç›´æ¥åœ¨æ–‡æœ¬æ¡†ä¸­è¾“å…¥ã€‚é¢„å¡«çš„å»ºè®®ä¼šåœ¨æ‚¨è¾“å…¥æ—¶æ¶ˆå¤±ï¼Œå¦‚æœç•™ç©ºåˆ™ä¼šé‡æ–°å‡ºç°ã€‚</li>
                <li>ä¿å­˜ä¸ºPDFï¼šç‚¹å‡»é¡µé¢åº•éƒ¨çš„â€œä¸‹è½½ä¸ºPDFâ€æŒ‰é’®ã€‚è¿™å°†æ‰“å¼€æ‚¨æµè§ˆå™¨çš„æ‰“å°å¯¹è¯æ¡†ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­é€‰æ‹©â€œä¿å­˜ä¸ºPDFâ€ï¼ˆæˆ–ç±»ä¼¼â€œMicrosoft Print to PDFâ€çš„é€‰é¡¹ï¼‰ä½œä¸ºç›®æ ‡ã€‚</li>
                <li>**å‘é€æ‚¨çš„ç­”æ¡ˆï¼š** æ‚¨ç°åœ¨æœ‰ä¸¤ä¸ªçµæ´»çš„é€‰æ‹©ï¼š
                    <ul class="romantic-list handwritten-guide-text mt-2 ml-4">
                        <li>**é€‰é¡¹1ï¼šç›´æ¥å‘é€ï¼ˆæ¨èï¼‰ï¼š** å®Œæˆé—®å·åï¼Œä½¿ç”¨ä¸‹é¢çš„â€œç›´æ¥å‘é€ç­”æ¡ˆç»™Elijah â¤ï¸â€æŒ‰é’®ã€‚è¿™å°†é€šè¿‡æˆ‘ä»¬çš„æœåŠ¡åˆä½œä¼™ä¼´å®‰å…¨åœ°å‘é€æ‚¨çš„ç­”æ¡ˆï¼ŒElijahå°†ç«‹å³æ”¶åˆ°å®ƒä»¬ã€‚</li>
                        <li>**é€‰é¡¹2ï¼šé€šè¿‡æ‚¨çš„ç”µå­é‚®ä»¶åº”ç”¨ç¨‹åºå‘é€ï¼ˆæ›¿ä»£ï¼‰ï¼š** å¦‚æœç›´æ¥å‘é€é€‰é¡¹ä¸å¯ç”¨æˆ–ä¸é¦–é€‰ï¼Œç‚¹å‡»â€œé€šè¿‡æ‚¨çš„ç”µå­é‚®ä»¶åº”ç”¨ç¨‹åºå‘é€ç­”æ¡ˆ ğŸ“§â€æŒ‰é’®ã€‚è¿™å°†æ‰“å¼€æ‚¨è®¾å¤‡çš„ç”µå­é‚®ä»¶ç¨‹åºï¼Œå…¶ä¸­åŒ…å«æ‚¨é¢„å¡«çš„ç­”æ¡ˆã€‚ç„¶åæ‚¨å¯ä»¥æ‰‹åŠ¨å‘é€ç”µå­é‚®ä»¶ã€‚</li>
                    </ul>
                </li>
                <li class="mt-4 no-print">å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·è®¨è®ºæ‚¨çš„å›å¤ï¼Œä»¥åŠ æ·±æˆ‘ä»¬ä¹‹é—´çš„ç›¸äº’ç†è§£ã€‚</li>
            </ul>
        </details>

        <!-- New Introduction Section -->
        <section class="intro-section-text">
            å½“æ‚¨å¼€å§‹è¿™æ®µç¾ä¸½çš„é—®å·ä¹‹æ—…æ—¶ï¼Œè¯·è®°ä½ï¼Œæ¯ä¸ªç­”æ¡ˆéƒ½æ˜¯æ‚¨å¿ƒçµå’Œæ€æƒ³ä¸­çè´µçš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ä»…ä»…æ˜¯ä¸ºäº†è¾¾æˆä¸€è‡´ï¼Œæ›´æ˜¯ä¸ºäº†çœŸæ­£çœ‹åˆ°å’Œåº†ç¥æ‚¨æ˜¯å¤šä¹ˆäº†ä¸èµ·çš„ä¸ªä½“ï¼Œä»¥åŠæ‚¨çš„ç‹¬ç‰¹ç²¾ç¥å¦‚ä½•ä¸æˆ‘äº¤ç»‡ï¼Œå…±åŒæç»˜æˆ‘ä»¬ç¾å¥½çš„ç”Ÿæ´»ã€‚è¯·æ…¢æ…¢æ¥ï¼Œè®©æ‚¨çš„æ€ç»ªè‡ªç”±æµæ·Œï¼ŒçŸ¥é“æˆ‘éå¸¸æœŸå¾…é˜…è¯»æ‚¨çš„æ¯ä¸€ä¸ªå­—ã€‚
            <!-- Placeholder for an animated sticker/GIF - replace with actual URL if desired -->
            <!-- Example: <img src="https://media.giphy.com/media/v1.gif" alt="Animated Heart" class="animated-sticker no-print"> -->
        </section>

        <!-- Recollection Animation Section -->
        <div id="recollectionAnimation" class="recollection-animation-container no-print">
            <span class="heart-pulse">â¤ï¸</span>
        </div>

        <!-- Start of the FORM tag for Formspree submission -->
        <form id="loveQuizForm" action="https://formspree.io/f/mqabgreo" method="POST">
            <!-- Questionnaire Section -->
            <main class="space-y-8">
                <!-- Question 1: Shared Values and Beliefs -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q1" class="block handwritten-question-label mb-2">
                        1. æ‚¨è®¤ä¸ºæˆ‘ä»¬æ‹¥æœ‰ç›¸ä¼¼çš„æ ¸å¿ƒä»·å€¼è§‚æˆ–ä¿¡ä»°æœ‰å¤šé‡è¦ï¼Ÿæ‚¨å¦‚ä½•çœ‹å¾…è¿™ä¼šå½±å“æˆ‘ä»¬æœªæ¥çš„å…±åŒç”Ÿæ´»ï¼Ÿ
                    </label>
                    <textarea id="q1" name="q1_values" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 2: Embracing a Shared Future -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q2" class="block handwritten-question-label mb-2">
                        2. ä½œä¸ºä¸€å¯¹æ–°å¼€å§‹çš„ä¼´ä¾£ï¼Œå…±åŒå»ºè®¾æœªæ¥å’Œåˆ›é€ æ–°ä½“éªŒï¼Œæœ€è®©æ‚¨å…´å¥‹çš„æ˜¯ä»€ä¹ˆï¼Ÿ
                    </label>
                    <textarea id="q2" name="q2_future" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 3: A New Chapter Together -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q3" class="block handwritten-question-label mb-2">
                        3. å¦‚æœæˆ‘ä»¬ç»„å»ºå®¶åº­ï¼Œæ‚¨è®¤ä¸ºæˆ‘ä»¬ç¬¬ä¸€æ¬¡å…±åŒç»å†ä¸ºäººçˆ¶æ¯çš„ç»å†æœ‰å¤šé‡è¦ï¼Ÿ
                    </label>
                    <textarea id="q3" name="q3_parenthood" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 4: Mutual Respect and Partnership -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q4" class="block handwritten-question-label mb-2">
                        4. æ‚¨å¦‚ä½•çœ‹å¾…å…³ç³»ä¸­é¢†å¯¼ä¸ä¼™ä¼´å…³ç³»çš„å¹³è¡¡ï¼Œä»¥åŠâ€œå°Šé‡â€åœ¨è¿™ç§åŠ¨æ€ä¸­æ„å‘³ç€ä»€ä¹ˆï¼Ÿ
                    </label>
                    <textarea id="q4" name="q4_leadership_respect" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 5: A Shared Vision for Family Life -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q5" class="block handwritten-question-label mb-2">
                        5. æ‚¨å¦‚ä½•è®¾æƒ³å­©å­åœ¨æˆ‘ä»¬å©šå§»ä¸­çš„è§’è‰²ï¼Œä»¥åŠå¯¹æ‚¨æ¥è¯´æŠšå…»ä»–ä»¬çœŸæ­£æ„å‘³ç€ä»€ä¹ˆï¼Ÿ
                    </label>
                    <textarea id="q5" name="q5_children_role" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 6: The Value of True Friendship -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q6" class="block handwritten-question-label mb-2">
                        6. æ‚¨çš„å‹è°Šå¦‚ä½•ä¸°å¯Œæ‚¨çš„ç”Ÿæ´»ï¼Œä»¥åŠæ‚¨å¦‚ä½•å¹³è¡¡æ‚¨çš„ç¤¾äº¤å…³ç³»ä¸æˆ‘ä»¬çš„å…³ç³»ï¼Ÿ
                    </label>
                    <textarea id="q6" name="q6_friendships" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 7: Harmonious Compatibility -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q7" class="block handwritten-question-label mb-2">
                        7. ä»€ä¹ˆèƒ½ä¸ºæ‚¨åœ¨ä¼´ä¾£å…³ç³»ä¸­åˆ›é€ æŒä¹…çš„èˆ’é€‚æ„Ÿã€å¸å¼•åŠ›å’Œæ·±åˆ»çš„å…¼å®¹æ€§ï¼Ÿ
                    </label>
                    <textarea id="q7" name="q7_compatibility" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 8: Seamless Integration and Unity -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q8" class="block handwritten-question-label mb-2">
                        8. æ‚¨å¦‚ä½•çœ‹å¾…æˆ‘ä»¬ä½œä¸ºä¸€å¯¹å¤«å¦‡å»ºç«‹ä¸€ä¸ªå¼ºå¤§ã€å›¢ç»“çš„é˜µçº¿ï¼Œå°¤å…¶æ˜¯åœ¨é¢å¯¹å¤–éƒ¨æŒ‘æˆ˜æˆ–èå…¥æˆ‘ä»¬çš„å®¶åº­æ—¶ï¼Ÿ
                    </label>
                    <textarea id="q8" name="q8_united_front" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 9: Intimacy and Respect (Public and Private) -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q9" class="block handwritten-question-label mb-2">
                        9. ç§äººäº²å¯†å’Œå…¬å…±å°Šé‡åœ¨å»ºç«‹ç‰¢å›ºæŒä¹…çš„å…³ç³»ä¸­æœ‰å¤šé‡è¦ï¼Ÿ
                    </label>
                    <textarea id="q9" name="q9_intimacy_respect" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 10: Cherished Companionship -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q10" class="block handwritten-question-label mb-2">
                        10. ä»€ä¹ˆè®©æ‚¨çœŸæ­£äº«å—ä¸ä¼´ä¾£å…±åº¦æ—¶å…‰ï¼Œä»¥åŠæ‚¨å–œæ¬¢å¦‚ä½•ç§¯æåŸ¹å…»è¿™ç§è”ç³»ï¼Ÿ
                    </label>
                    <textarea id="q10" name="q10_companionship" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 11: Valuing Shared Time and Presence -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q11" class="block handwritten-question-label mb-2">
                        11. æ‚¨æ›´å–œæ¬¢å¦‚ä½•å…±åŒåº¦è¿‡é«˜è´¨é‡çš„æ—¶å…‰ï¼Œä»¥åŠåœ¨é‚£äº›æ—¶åˆ»ï¼Œä»€ä¹ˆè®©æ‚¨æ„Ÿåˆ°æœ€äº²è¿‘å’ŒæŠ•å…¥ï¼Ÿ
                    </label>
                    <textarea id="q11" name="q11_quality_time" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 12: Mutual Support and Clear Communication -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q12" class="block handwritten-question-label mb-2">
                        12. å½“æˆ‘ä»¬é¢ä¸´è‰°éš¾çš„å†³å®šæˆ–æŒ‘æˆ˜æ—¶ï¼Œæ‚¨å¦‚ä½•çœ‹å¾…æˆ‘ä»¬ç›¸äº’æ”¯æŒå’Œæœ‰æ•ˆæ²Ÿé€šä»¥æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Ÿ
                    </label>
                    <textarea id="q12" name="q12_support_comm" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>

                <!-- Question 13: Commitment to the Partnership -->
                <div class="bg-gray-50 p-6 rounded-lg shadow-sm border border-gray-100">
                    <label for="q13" class="block handwritten-question-label mb-2">
                        13. å¯¹æ‚¨æ¥è¯´ï¼Œé•¿æœŸä¼´ä¾£å…³ç³»ä¸­çš„â€œæ‰¿è¯ºâ€æ„å‘³ç€ä»€ä¹ˆï¼Ÿæ‚¨è®¤ä¸ºæˆ‘ä»¬åŒæ–¹éœ€è¦æŒç»­ä»˜å‡ºå“ªäº›åŠªåŠ›æ‰èƒ½è®©å©šå§»çœŸæ­£è“¬å‹ƒå‘å±•ï¼Ÿ
                    </label>
                    <textarea id="q13" name="q13_commitment" class="w-full" onfocus="handleFocus(this)" onblur="handleBlur(this)"></textarea>
                </div>
            </main>

            <!-- Final Legal Agreement Section -->
            <section class="final-legal-section">
                <h2 class="handwritten-guide-title">æœ€ç»ˆåè®®ä¸ç¡®è®¤</h2>
                <div class="legal-content-area">
                    <!-- Collapsible Legal Terms -->
                    <details id="legalTermsDetails" class="legal-terms-details">
                        <summary>
                            <span class="handwritten-guide-text more-instructions-text" style="font-family: 'Inter', sans-serif;">
                                ç‚¹å‡»æŸ¥çœ‹æ¡æ¬¾ä¸æ¡ä»¶ã€‚
                            </span>
                        </summary>
                        <h3 class="text-xl font-bold mb-2">é—®å·ä½¿ç”¨æ¡æ¬¾ä¸æ¡ä»¶</h3>
                        <p class="mb-4 text-sm">
                            æœ¬â€œæˆ‘ä»¬çš„å…±åŒæ—…ç¨‹ï¼šä¸€ä»½å…³ç³»é—®å·â€ï¼ˆâ€œæ–‡ä»¶â€ï¼‰ä»…ç”¨äºä¿ƒè¿›ç§äººæµªæ¼«å…³ç³»ä¸­çš„ä¸ªäººç†è§£å’Œæ²Ÿé€šã€‚ç»§ç»­æ“ä½œå³è¡¨ç¤ºæ‚¨æ‰¿è®¤å¹¶åŒæ„ä»¥ä¸‹æ¡æ¬¾ï¼š
                        </p>
                        <ul class="list-disc list-inside mb-4 text-sm">
                            <li>**è‡ªæ„¿å‚ä¸ï¼š** æ‚¨å®Œæˆæœ¬æ–‡ä»¶å¹¶åˆ†äº«æ‚¨çš„å›å¤æ˜¯å®Œå…¨è‡ªæ„¿çš„ã€‚</li>
                            <li>**ä¿¡æ¯é¢„æœŸç”¨é€”ï¼š** æ‚¨åœ¨æœ¬æ–‡ä»¶ä¸­åˆ†äº«çš„ä»»ä½•ä¿¡æ¯ã€è§è§£æˆ–ä¸ªäººæ•°æ®ä»…ä¾›Elijahå’Œæ‚¨æœ¬äººç§äººä½¿ç”¨ï¼Œç”¨äºç›¸äº’ç†è§£å…³ç³»å’Œè®¨è®ºã€‚å®ƒä¸ç”¨äºå…¬å¼€æŠ«éœ²ã€å•†ä¸šç”¨é€”æˆ–è¶…å‡ºæ‚¨ç§äººå…³ç³»æ¢ç´¢èŒƒå›´çš„ä»»ä½•ç›®çš„ã€‚</li>
                            <li>**æ— æ³•å¾‹å»ºè®®ï¼š** æœ¬æ–‡ä»¶åŠå…¶å†…å®¹ä¸æ„æˆæ³•å¾‹å»ºè®®ã€å¿ƒç†å’¨è¯¢æˆ–ä»»ä½•å½¢å¼çš„ä¸“ä¸šæœåŠ¡ã€‚å®ƒçº¯ç²¹æ˜¯ä½œä¸ºä¸ªäººåæ€å’Œæ²Ÿé€šçš„å·¥å…·è€Œè®¾è®¡çš„ã€‚</li>
                            <li>**æ— æ³•å¾‹çº¦æŸåŠ›ï¼š** æœ¬æ–‡ä»¶çš„å®Œæˆå’Œæäº¤ï¼Œä»¥åŠå…¶ä¸­æåŠçš„ä»»ä½•æ¡æ¬¾ï¼Œä¸æ„æˆæ‚¨ä¸Elijahä¹‹é—´å…·æœ‰æ³•å¾‹çº¦æŸåŠ›çš„åˆåŒæˆ–åè®®ï¼Œä¹Ÿä¸å»ºç«‹è¶…å‡ºç§äººä¸ªäººå…³ç³»èŒƒå›´çš„ä»»ä½•æ­£å¼æ³•å¾‹ä¹‰åŠ¡æˆ–æƒåˆ©ã€‚</li>
                            <li>**å…è´£å£°æ˜ï¼š** Elijahå¯¹æœ¬æ–‡ä»¶ä¸­åŒ…å«çš„ä¿¡æ¯çš„ä½¿ç”¨æˆ–æ»¥ç”¨ï¼Œæˆ–å› æ‚¨çš„å‚ä¸è€Œäº§ç”Ÿçš„ä»»ä½•ç»“æœä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚</li>
                        </ul>

                        <h3 class="text-xl font-bold mt-6 mb-2">ä¿å¯†ä¸ç‰ˆæƒå£°æ˜</h3>
                        <p class="mb-4 text-sm">
                            æœ¬æ–‡ä»¶ï¼ŒåŒ…æ‹¬å…¶ç»“æ„ã€é—®é¢˜ã€è®¾è®¡å’Œæ–‡æœ¬å†…å®¹ï¼Œæ˜¯Elijahçš„çŸ¥è¯†äº§æƒï¼Œå¹¶å—ç‰ˆæƒä¿æŠ¤ã€‚é€šè¿‡è®¿é—®å’Œä½¿ç”¨æœ¬æ–‡ä»¶ï¼Œæ‚¨åŒæ„ä»¥ä¸‹å†…å®¹ï¼š
                        </p>
                        <ul class="list-disc list-inside mb-4 text-sm">
                            <li>**ä¿å¯†æ€§ï¼š** æœ¬æ–‡ä»¶çš„å†…å®¹æ˜¯ä¿å¯†çš„ï¼Œä»…ä¾›æ‚¨ä½œä¸ºä¸Elijahç§äººå…³ç³»çš„ä¸€éƒ¨åˆ†çš„ä¸ªäººä½¿ç”¨ã€‚</li>
                            <li>**ç¦æ­¢å¤åˆ¶æˆ–åˆ†å‘ï¼š** æ‚¨åŒæ„æœªç»Elijahäº‹å…ˆä¹¦é¢åŒæ„ï¼Œä¸å¾—å¤åˆ¶ã€é‡åˆ¶ã€åˆ†å‘ã€å‡ºç‰ˆã€å±•ç¤ºã€æ‰§è¡Œã€ä¿®æ”¹ã€åˆ›ä½œè¡ç”Ÿä½œå“ã€ä¼ è¾“æˆ–ä»¥ä»»ä½•æ–¹å¼åˆ©ç”¨æœ¬æ–‡ä»¶çš„ä»»ä½•éƒ¨åˆ†ã€‚</li>
                            <li>**ç‰ˆæƒä¾µæƒï¼š** æœªç»æˆæƒå¤åˆ¶æˆ–åˆ†å‘æœ¬æ–‡ä»¶å¯èƒ½æ„æˆç‰ˆæƒä¾µæƒï¼Œå¹¶å¯èƒ½å¯¼è‡´æ³•å¾‹è¯‰è®¼ã€‚</li>
                        </ul>
                    </details>

                    <!-- Acknowledgment Checkbox and Signature Box (always visible, but content toggled by checkbox) -->
                    <div class="mt-6">
                        <div class="consent-checkbox-container">
                            <label for="consentCheckboxFinal" class="flex items-center justify-center cursor-pointer">
                                <input type="checkbox" id="consentCheckboxFinal" name="consent_agreed" value="Yes" class="form-checkbox h-5 w-5 text-pink-600 rounded mr-3">
                                æˆ‘å·²é˜…è¯»ã€ç†è§£å¹¶åŒæ„ä¸Šè¿°æ¡æ¬¾ã€åŒæ„ä¹¦å’Œä¿å¯†åè®®ã€‚
                            </label>
                        </div>

                        <!-- Signature/Name Input Box -->
                        <div id="signatureBox" class="signature-box hidden">
                            <label for="fullNameInput">
                                è¯·è¾“å…¥æ‚¨çš„å…¨åä»¥ç¡®è®¤ï¼š
                            </label>
                            <input type="text" id="fullNameInput" name="acknowledged_by" placeholder="æ‚¨çš„å…¨å">
                            <p class="acknowledgement-text">
                                è¿™å°†ä½œä¸ºæ‚¨çš„æ•°å­—ç¡®è®¤ã€‚
                            </p>
                            <div class="mt-4 pt-4">
                                <p id="displayedSignature" class="dancing-script-signature"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Email Address Input Container -->
            <section class="email-input-bottom-container no-print">
                <label for="senderEmail" class="block text-lg font-medium text-gray-800 mb-2">
                    æ‚¨çš„ç”µå­é‚®ç®±åœ°å€ï¼š
                </label>
                <input type="email" id="senderEmail" name="_replyto" class="w-full" placeholder="æ‚¨çš„é‚®ç®±@example.com">
            </section>

            <!-- Formspree Direct Submission Box -->
            <div class="direct-submit-box no-print">
                <p class="message-text">
                    æ„Ÿè°¢æ‚¨è¿ˆå‡ºè¿™ç¬¬ä¸€æ­¥ï¼æˆ‘å¸Œæœ›è¿™èƒ½å¯¹æ‚¨æ¥è¯´çœŸçš„ç®€å•ã€‚å½“æ‚¨å‡†å¤‡å¥½æ—¶ï¼Œåªéœ€ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®ï¼Œæ‚¨çš„ç­”æ¡ˆå°†ç›´æ¥å‘é€åˆ°æˆ‘çš„æ”¶ä»¶ç®±ã€‚è¿™æ˜¯ä¸€ç§å®‰å…¨ã€è½»æ¾çš„æ–¹å¼ï¼Œè®©æˆ‘ä»¬åœ¨ç»§ç»­å»ºè®¾æœªæ¥æ—¶æ›´åŠ äº²è¿‘ã€‚æˆ‘éå¸¸æœŸå¾…æˆ‘ä»¬çš„ä¸‹ä¸€æ¬¡å¯¹è¯ï¼
                </p>
                <!-- This button will now submit the form directly to Formspree -->
                <button type="submit" class="btn-primary" id="submitFormButton">
                    ç›´æ¥å‘é€ç­”æ¡ˆç»™Elijah â¤ï¸
                </button>
            </div>
        </form> <!-- End of the FORM tag (moved so mailto button is outside form) -->

        <!-- NEW: Mailto Submission Box (Outside the Form) -->
        <div class="mailto-submit-box no-print">
            <p class="message-text">
                ä½œä¸ºæ›¿ä»£ï¼Œå¦‚æœç›´æ¥å‘é€é€‰é¡¹å¯¹æ‚¨ä¸èµ·ä½œç”¨ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨æ‚¨è®¾å¤‡çš„ç”µå­é‚®ä»¶åº”ç”¨ç¨‹åºå‘é€æ‚¨çš„ç­”æ¡ˆã€‚è¿™å°†æ‰“å¼€ä¸€ä¸ªæ–°çš„ç”µå­é‚®ä»¶è‰ç¨¿ï¼Œå…¶ä¸­åŒ…å«æ‚¨å‡†å¤‡å‘é€çš„æ‰€æœ‰å›å¤ã€‚
            </p>
            <button type="button" class="btn-primary" id="sendEmailClientButton">
                é€šè¿‡æ‚¨çš„ç”µå­é‚®ä»¶åº”ç”¨ç¨‹åºå‘é€ç­”æ¡ˆ ğŸ“§
            </button>
        </div>


        <!-- Footer (now only contains PDF button) -->
        <footer class="text-center mt-12 p-4 bg-blue-50 rounded-lg border border-blue-200 no-print">
            <h3 class="text-xl sm:text-2xl font-semibold text-blue-700 mb-3">æ„Ÿè°¢æ‚¨çš„æ·±æ€ç†Ÿè™‘çš„å›å¤ï¼</h3>
            <p class="text-gray-700 leading-relaxed mb-4">
                æ‚¨çš„ç­”æ¡ˆå°†ä¸ºæˆ‘ä»¬å…³äºå…±åŒæœªæ¥çš„å¯¹è¯æä¾›å®è´µçš„è§è§£ã€‚
            </p>
            <button onclick="window.print()" class="btn-primary btn-pdf">
                ä¸‹è½½ä¸ºPDF
            </button>
            <p class="text-gray-600 text-lg font-semibold italic mt-4">çˆ±ä½ çš„ï¼ŒElijah</p>
        </footer>
    </div>

    <script>
        // Store recipient email globally
        const RECIPIENT_EMAIL = "iliemagureanu2023@gmail.com"; // This is still used by Formspree internally for the reply-to header

        // Pre-filled answers for each question (Mandarin translations)
        const prefilledAnswers = {
            q1: "å¯¹äºæˆ‘ä»¬å…±åŒçš„é“è·¯æ¥è¯´ï¼Œä»·å€¼è§‚è‡³å…³é‡è¦ï¼Œå®ƒç¡®ä¿æˆ‘ä»¬çš„åŸºç¡€ä¸ç¥åœ£åŸåˆ™å’Œå…±åŒçš„ç”Ÿæ´»ç›®æ ‡ä¿æŒä¸€è‡´ã€‚",
            q2: "æœ€è®©æˆ‘å…´å¥‹çš„æ˜¯ï¼Œèƒ½å¤Ÿä»¥æˆ‘ä»¬å…±åŒçš„ä¿¡ä»°ä¸ºåŸºç¡€ï¼Œå…±åŒå»ºç«‹ä¸€ä¸ªå®¶ï¼Œè¿™ä¸ªæ–°å®¶åº­å°†åæ˜ æˆ‘ä»¬çš„ä»·å€¼è§‚å’Œæ‰¿è¯ºã€‚",
            q3: "éå¸¸é‡è¦ã€‚ç¬¬ä¸€æ¬¡å…±åŒç»å†ä¸ºäººçˆ¶æ¯çš„æ—…ç¨‹ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´æ˜¯ä¸€ä¸ªç¥åœ£çš„å…±åŒæ—…ç¨‹ã€‚",
            q4: "å°Šé‡æ„å‘³ç€å°Šé‡ç¥åœ£çš„ç§©åºï¼Œç”·äººä»¥çˆ±å¼•å¯¼ï¼Œå¥³äººä»¥æ™ºæ…§æ”¯æŒï¼Œç¡®ä¿å…±åŒæˆé•¿ã€‚",
            q5: "å­©å­æ˜¯ç¥ç¦ï¼Œè¦ä»¥ä¿¡ä»°å’Œçºªå¾‹æ¥æŠšå…»ï¼Œç†è§£ä»–ä»¬ç²¾ç¥å’Œé“å¾·å‘å±•æ‰€éœ€çš„æ‰¿è¯ºã€‚",
            q6: "çœŸæ­£çš„å‹è°Šå¯¹æ”¯æŒè‡³å…³é‡è¦ï¼Œä½†åœ¨å©šå§»ä¸­ï¼Œæˆ‘ä»¬çš„ä¸»è¦è”ç³»ä¼˜å…ˆï¼Œæœ‹å‹å°†å’Œè°åœ°èå…¥æˆ‘ä»¬çš„å…±åŒç”Ÿæ´»ã€‚",
            q7: "æ·±åˆ»çš„å…¼å®¹æ€§æºäºå…±åŒçš„ä¿¡ä»°ã€ç›¸äº’çš„å°Šé‡ï¼Œä»¥åŠåœ¨çˆ±ä¸ç†è§£ä¸­å…±åŒæˆé•¿çš„æ„æ„¿ï¼Œæ¥å—å½¼æ­¤çš„ä¸å®Œç¾ã€‚",
            q8: "å»ºç«‹ä¸€ä¸ªå¼ºå¤§çš„ç»Ÿä¸€æˆ˜çº¿æ„å‘³ç€æŠŠæˆ‘ä»¬çš„å©šå§»å…³ç³»æ”¾åœ¨é¦–ä½ï¼Œå§‹ç»ˆä¿æŒç»Ÿä¸€ç«‹åœºï¼Œå°¤å…¶æ˜¯åœ¨é¢å¯¹å¤–éƒ¨å½±å“æ—¶ã€‚",
            q9: "ç§äººäº²å¯†å’Œå…¬å…±å°Šé‡éƒ½æ˜¯å»ºç«‹ç‰¢å›ºæŒä¹…å…³ç³»çš„åŸºçŸ³ï¼›ç§äººäº²å¯†åŠ æ·±æˆ‘ä»¬çš„è”ç³»ï¼Œè€Œå…¬å…±å°Šé‡åˆ™å‘ä¸–ç•Œå±•ç°æˆ‘ä»¬çš„å…³ç³»ã€‚",
            q10: "æˆ‘æœ€å–œæ¬¢ä¸€èµ·åº¦è¿‡æ—¶å…‰ï¼Œå½“æˆ‘ä»¬å‚ä¸æœ‰æ„ä¹‰çš„æ´»åŠ¨ï¼Œåœ¨ä¿¡ä»°ä¸­æˆé•¿ï¼Œæˆ–è€…åªæ˜¯çæƒœå½¼æ­¤å®‰é™çš„å¥‰çŒ®æ—¶åˆ»ã€‚",
            q11: "é«˜è´¨é‡çš„æ—¶å…‰æ„å‘³ç€æœ‰æ„è¯†çš„è¿æ¥æ—¶åˆ»ã€ç²¾ç¥æ»‹å…»å’Œå…±åŒçš„æ„¿æ™¯è§„åˆ’ï¼Œä¸“æ³¨äºå®è´µçš„ã€ä¸“å±çš„å…±åŒæ—¶é—´ã€‚",
            q12: "åœ¨é¢ä¸´æŒ‘æˆ˜æˆ–å›°éš¾å†³ç­–æ—¶ï¼Œæ”¯æŒæ„å‘³ç€ç§¯æå€¾å¬ã€ç¥ˆç¥·å¹¶å¯»æ±‚ç¥åœ£æŒ‡å¼•ã€‚æ²Ÿé€šè¦æ¸…æ™°ã€çœŸè¯šï¼Œå¹¶æ ¹æ¤äºçˆ±å’Œè€å¿ƒã€‚",
            q13: "æ‰¿è¯ºæ˜¯ä¸Šå¸é¢å‰çš„ç»ˆèº«ç›Ÿçº¦ï¼Œéœ€è¦æŒç»­çš„åŠªåŠ›ã€ç‰ºç‰²ï¼Œä»¥åŠå¯¹æˆ‘ä»¬å…±åŒç²¾ç¥å’Œå®¶åº­æ—…ç¨‹åšå®šä¸ç§»çš„å¥‰çŒ®ã€‚"
        };

        // Custom modal function (replaces window.alert for better control)
        function showCustomModal(contentHtml, modalId = 'customModalOverlay') {
            const existingModal = document.getElementById(modalId);
            if (existingModal) {
                existingModal.remove();
            }

            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'modal-overlay';
            modalOverlay.id = modalId;
            modalOverlay.innerHTML = `
                <div class="modal-content">
                    <button class="modal-close-btn" onclick="closeCustomModal('${modalId}')">X</button>
                    ${contentHtml}
                </div>
            `;
            document.body.appendChild(modalOverlay);

            // Dynamically adjust textarea height within modal if it exists
            const answersTextarea = document.getElementById('emailAnswersTextarea');
            if (answersTextarea) {
                answersTextarea.style.height = 'auto';
                answersTextarea.style.maxHeight = 'calc(90vh - 150px)';
                answersTextarea.style.overflowY = 'auto';
                answersTextarea.style.height = (answersTextarea.scrollHeight) + 'px';
            }
        }

        function closeCustomModal(modalId = 'customModalOverlay') {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.remove();
            }
        }

        // Function to set initial answer in textarea
        function setInitialAnswer(textarea) {
            const qId = textarea.id;
            // Ensure prefilledAnswers has the key
            if (prefilledAnswers[qId]) {
                textarea.value = prefilledAnswers[qId];
                textarea.classList.add('initial-answer');
                textarea.style.height = 'auto'; // Recalculate height
                textarea.style.height = (textarea.scrollHeight) + 'px';
            }
        }

        // Handle textarea focus (clear pre-filled text)
        function handleFocus(textarea) {
            const qId = textarea.id;
            // Check if current value matches prefilled before clearing
            if (textarea.value === prefilledAnswers[qId]) {
                textarea.value = '';
                textarea.classList.remove('initial-answer');
                textarea.style.height = 'auto'; // Recalculate height
            }
        }

        // Handle textarea blur (restore pre-filled text if empty)
        function handleBlur(textarea) {
            const qId = textarea.id;
            if (textarea.value.trim() === '') {
                // Restore prefilled text if empty
                textarea.value = prefilledAnswers[qId];
                textarea.classList.add('initial-answer');
                textarea.style.height = 'auto'; // Recalculate height
                textarea.style.height = (textarea.scrollHeight) + 'px';
            }
        } // Removed the extra ')' here, fixing the SyntaxError

        // Auto-resize textareas based on content (for user input)
        document.addEventListener('input', function (event) {
            if (event.target.tagName.toLowerCase() === 'textarea' && !event.target.classList.contains('initial-answer')) {
                event.target.style.height = 'auto';
                event.target.style.height = (event.target.scrollHeight) + 'px';
            }
        });

        // Function to validate email format
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        // Function to collect all answers for mailto
        function collectAnswersForMailto() {
            let answersText = '';

            // 1. Collect Questionnaire Answers
            document.querySelectorAll('main textarea').forEach(textarea => {
                const questionLabel = textarea.previousElementSibling.textContent.trim();
                let answer = textarea.value.trim();

                // If the answer is still the pre-filled one, send an empty string.
                if (prefilledAnswers[textarea.id] && answer === prefilledAnswers[textarea.id]) {
                    answer = '';
                }

                answersText += `${questionLabel}\n`;
                answersText += `å›å¤: ${answer || '[æœªæä¾›å›å¤]'}\n\n`;
            });

            // 2. Collect Email Address
            const senderEmailInput = document.getElementById('senderEmail');
            if (senderEmailInput && senderEmailInput.value.trim()) {
                answersText += `--- å‘ä»¶äººä¿¡æ¯ ---\n`;
                answersText += `å‘ä»¶äººé‚®ç®±: ${senderEmailInput.value.trim()}\n\n`;
            }

            // 3. Collect Legal Consent & Acknowledgment
            const consentCheckboxFinal = document.getElementById('consentCheckboxFinal');
            const legalTermsDetailsElement = document.getElementById('legalTermsDetails');
            const fullNameInput = document.getElementById('fullNameInput');

            answersText += `--- æ³•å¾‹ç¡®è®¤ ---\n`;

            if (consentCheckboxFinal && consentCheckboxFinal.checked) {
                const consentLabelElement = document.querySelector('label[for="consentCheckboxFinal"]');
                const consentLabelText = consentLabelElement ? Array.from(consentLabelElement.childNodes)
                                                        .filter(node => node.nodeType === Node.TEXT_NODE)
                                                        .map(node => node.textContent.trim())
                                                        .join(' ') : '';
                answersText += `åŒæ„: ${consentLabelText} - å·²åŒæ„\n`;

                if (fullNameInput && fullNameInput.value.trim()) {
                    answersText += `ç¡®è®¤äºº (è¾“å…¥å§“å): ${fullNameInput.value.trim()}\n`;
                } else {
                    answersText += `ç¡®è®¤äºº (è¾“å…¥å§“å): [æœªæä¾›ï¼Œä½†å·²å‹¾é€‰]\n`;
                }

                if (legalTermsDetailsElement) {
                    const wasOpen = legalTermsDetailsElement.open;
                    legalTermsDetailsElement.open = true; // Temporarily open to get full text
                    const fullLegalText = legalTermsDetailsElement.textContent.replace(/\s+/g, ' ').trim();
                    answersText += `å·²å®¡é˜…å®Œæ•´æ³•å¾‹æ¡æ¬¾: ${fullLegalText.substring(0, 500)}...\n`; // Truncate for mailto URL length
                    legalTermsDetailsElement.open = wasOpen; // Revert to original state
                }
            } else {
                answersText += `åŒæ„: æœªåŒæ„ (æœªå‹¾é€‰)\n`;
                answersText += `ç¡®è®¤äºº (è¾“å…¥å§“å): [æœªæä¾›]\n`;
            }

            return encodeURIComponent(answersText); // Encode for URL
        }


        // --- Document Ready and Form Submission Logic ---
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize all textareas with pre-filled answers on load
            document.querySelectorAll('textarea').forEach(textarea => {
                setInitialAnswer(textarea);
            });

            // Get form elements and the form itself
            const loveQuizForm = document.getElementById('loveQuizForm');
            const consentCheckboxFinal = document.getElementById('consentCheckboxFinal');
            const fullNameInput = document.getElementById('fullNameInput');
            const signatureBox = document.getElementById('signatureBox');
            const displayedSignature = document.getElementById('displayedSignature');
            const legalTermsDetails = document.getElementById('legalTermsDetails');
            const senderEmailInput = document.getElementById('senderEmail');
            const submitFormButton = document.getElementById('submitFormButton');
            const sendEmailClientButton = document.getElementById('sendEmailClientButton'); // New button


            // Toggle signature box visibility based on checkbox
            if (consentCheckboxFinal && fullNameInput && signatureBox && displayedSignature) {
                consentCheckboxFinal.addEventListener('change', function() {
                    if (this.checked) {
                        signatureBox.classList.remove('hidden');
                        if (fullNameInput.value.trim() !== '') {
                            displayedSignature.textContent = fullNameInput.value.trim();
                        }
                    } else {
                        signatureBox.classList.add('hidden');
                        displayedSignature.textContent = '';
                        fullNameInput.value = '';
                    }
                });

                fullNameInput.addEventListener('input', function() {
                    displayedSignature.textContent = this.value.trim();
                });
            }

            // *** MAIN FORM SUBMISSION LOGIC FOR FORMSPREE ***
            if (loveQuizForm && submitFormButton) {
                loveQuizForm.addEventListener('submit', async function(event) {
                    event.preventDefault(); // Prevent default browser form submission

                    // --- 1. Perform Validations ---
                    if (!legalTermsDetails.open) {
                         showCustomModal(`
                            <p class="text-lg font-semibold mb-4">è¯·å…ˆå®¡é˜…æ¡æ¬¾ï¼</p>
                            <p class="text-gray-700 mb-6">è¯·å±•å¼€â€œç‚¹å‡»æŸ¥çœ‹æ¡æ¬¾ä¸æ¡ä»¶â€ä»¥åœ¨ç»§ç»­ä¹‹å‰å®¡é˜…æ¡æ¬¾ã€‚</p>
                            <button class="btn-primary" onclick="closeCustomModal()">æ˜ç™½äº†</button>
                        `);
                        legalTermsDetails.open = true; // Auto-open for user
                        return;
                    }

                    if (!consentCheckboxFinal || !consentCheckboxFinal.checked) {
                        showCustomModal(`
                            <p class="text-lg font-semibold mb-4">éœ€è¦åŒæ„ï¼</p>
                            <p class="text-gray-700 mb-6">è¯·å‹¾é€‰æ–¹æ¡†ä»¥åŒæ„æ¡æ¬¾ã€åŒæ„ä¹¦å’Œä¿å¯†åè®®ï¼Œç„¶åç»§ç»­ã€‚</p>
                            <button class="btn-primary" onclick="closeCustomModal()">æ˜ç™½äº†</button>
                        `);
                        consentCheckboxFinal.focus();
                        return;
                    }

                    const senderEmail = senderEmailInput.value.trim();
                    if (!senderEmail) {
                        showCustomModal(`
                            <p class="text-lg font-semibold mb-4">å“å‘€ï¼æ‚¨çš„é‚®ç®±ç¼ºå¤±</p>
                            <p class="text-gray-700 mb-6">è¯·è¾“å…¥æ‚¨çš„ç”µå­é‚®ç®±åœ°å€ä»¥ç»§ç»­ã€‚</p>
                            <button class="btn-primary" onclick="closeCustomModal()">æ˜ç™½äº†</button>
                        `);
                        return;
                    }
                    if (!isValidEmail(senderEmail)) {
                        showCustomModal(`
                            <p class="text-lg font-semibold mb-4">æ— æ•ˆçš„é‚®ç®±æ ¼å¼</p>
                            <p class="text-gray-700 mb-6">è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€ï¼ˆä¾‹å¦‚ï¼šæ‚¨çš„é‚®ç®±@example.comï¼‰ä»¥ç»§ç»­ã€‚</p>
                            <button class="btn-primary" onclick="closeCustomModal()">æ˜ç™½äº†</p>
                        `);
                        return;
                    }

                    const acknowledgedName = fullNameInput.value.trim();
                    if (!acknowledgedName) {
                        showCustomModal(`
                            <p class="text-lg font-semibold mb-4">è¯·ç¡®è®¤ï¼</p>
                            <p class="text-gray-700 mb-6">è¯·åœ¨ç¡®è®¤éƒ¨åˆ†è¾“å…¥æ‚¨çš„å…¨åä»¥ç¡®è®¤æ‚¨çš„åŒæ„ã€‚</p>
                            <button class="btn-primary" onclick="closeCustomModal()">æ˜ç™½äº†</button>
                        `);
                        fullNameInput.focus();
                        return;
                    }

                    // --- 2. Prepare Form Data for Formspree ---
                    const formData = new FormData(loveQuizForm);

                    // Filter out pre-filled answers if they haven't been changed by the user.
                    // Formspree will receive empty strings for these, which is what we want.
                    document.querySelectorAll('main textarea').forEach(textarea => {
                        const qId = textarea.id;
                        if (prefilledAnswers[qId] && textarea.value.trim() === prefilledAnswers[qId]) {
                            formData.set(textarea.name, ''); // Set to empty string
                        }
                    });

                    // Manually add the legal consent text and acknowledgment details
                    // Formspree will include these as separate fields in the email
                    formData.append('--- æ³•å¾‹åŒæ„å’Œç¡®è®¤è¯¦æƒ… ---', ''); // Separator

                    // Extract text from the legal terms details. outerText gets visible text.
                    // We need to temporarily force it open to get all text.
                    const legalTermsDetailsElement = document.getElementById('legalTermsDetails');
                    if (legalTermsDetailsElement) {
                        const wasOpen = legalTermsDetailsElement.open; // Store original state
                        legalTermsDetailsElement.open = true; // Force open
                        // Get the full text content, clean it up a bit
                        const fullLegalText = legalTermsDetailsElement.textContent.replace(/\s+/g, ' ').trim();
                        formData.append('å®Œæ•´æ³•å¾‹æ¡æ¬¾å’Œæ¡ä»¶', fullLegalText);
                        legalTermsDetailsElement.open = wasOpen; // Revert to original state
                    }
                    
                    const consentStatus = consentCheckboxFinal.checked ? 'å·²åŒæ„' : 'æœªåŒæ„';
                    const consentLabelElement = document.querySelector('label[for="consentCheckboxFinal"]');
                    if (consentLabelElement) {
                        // Extract just the core text of the label, removing checkbox/other elements if present
                        const consentLabelText = Array.from(consentLabelElement.childNodes)
                                                    .filter(node => node.nodeType === Node.TEXT_NODE)
                                                    .map(node => node.textContent.trim())
                                                    .join(' ');
                        formData.append('åŒæ„ç¡®è®¤', `${consentLabelText} - ${consentStatus}`);
                    }

                    const fullNameInputText = fullNameInput.value.trim();
                    if (fullNameInputText) {
                        formData.append('ç¡®è®¤äºº (è¾“å…¥å§“å)', fullNameInputText);
                    }


                    // --- 3. Submit to Formspree via Fetch API ---
                    try {
                        const response = await fetch(loveQuizForm.action, {
                            method: 'POST',
                            body: formData,
                            headers: {
                                'Accept': 'application/json' // Essential for AJAX submission without redirect
                            }
                        });

                        if (response.ok) {
                            showCustomModal(`
                                <p class="text-lg font-semibold mb-4">æˆåŠŸï¼æ‚¨çš„ç­”æ¡ˆå·²å‘é€ï¼</p>
                                <p class="text-gray-700 mb-6">æ„Ÿè°¢æ‚¨åˆ†äº«æ‚¨çš„æƒ³æ³•ã€‚Elijahå°†ç›´æ¥æ”¶åˆ°æ‚¨çš„ç­”æ¡ˆã€‚</p>
                                <button class="btn-primary" onclick="closeCustomModal()">å…³é—­</button>
                            `);
                            loveQuizForm.reset(); // Clear the form after successful submission
                            // Re-initialize prefilled answers after reset
                            document.querySelectorAll('textarea').forEach(textarea => {
                                setInitialAnswer(textarea);
                            });
                            consentCheckboxFinal.checked = false; // Uncheck consent
                            signatureBox.classList.add('hidden'); // Hide signature box
                            displayedSignature.textContent = ''; // Clear displayed signature
                        } else {
                            // Formspree returned an error (e.g., validation fail)
                            const data = await response.json();
                            let errorMessage = "å‘é€æ‚¨çš„ç­”æ¡ˆæ—¶å‡ºç°é”™è¯¯ã€‚è¯·å†è¯•ä¸€æ¬¡ã€‚";
                            if (data.errors && data.errors.length > 0) {
                                errorMessage = data.errors.map(err => err.message).join(", ");
                            }
                            showCustomModal(`
                                <p class="text-lg font-semibold mb-4">æäº¤å¤±è´¥ï¼</p>
                                <p class="text-gray-700 mb-6">${errorMessage}</p>
                                <button class="btn-primary" onclick="closeCustomModal()">å…³é—­</button>
                            `);
                        }
                    } catch (error) {
                        // Network error or other fetch-related issues
                        console.error('æäº¤é”™è¯¯:', error);
                        showCustomModal(`
                            <p class="text-lg font-semibold mb-4">ç½‘ç»œé”™è¯¯ï¼</p>
                            <p class="text-gray-700 mb-6">æ— æ³•è¿æ¥åˆ°æäº¤æœåŠ¡ã€‚è¯·æ£€æŸ¥æ‚¨çš„äº’è”ç½‘è¿æ¥å¹¶é‡è¯•ã€‚</p>
                            <button class="btn-primary" onclick="closeCustomModal()">å…³é—­</button>
                        `);
                    }
                });
            }

            // *** MAILTO SUBMISSION LOGIC ***
            if (sendEmailClientButton) {
                sendEmailClientButton.addEventListener('click', function() {
                    // Perform the same validations as for Formspree
                    if (!legalTermsDetails.open) {
                         showCustomModal(`
                            <p class="text-lg font-semibold mb-4">è¯·å…ˆå®¡é˜…æ¡æ¬¾ï¼</p>
                            <p class="text-gray-700 mb-6">è¯·å±•å¼€â€œç‚¹å‡»æŸ¥çœ‹æ¡æ¬¾ä¸æ¡ä»¶â€ä»¥åœ¨ç»§ç»­ä¹‹å‰å®¡é˜…æ¡æ¬¾ã€‚</p>
                            <button class="btn-primary" onclick="closeCustomModal()">æ˜ç™½äº†</button>
                        `);
                        legalTermsDetails.open = true; // Auto-open for user
                        return;
                    }

                    if (!consentCheckboxFinal || !consentCheckboxFinal.checked) {
                        showCustomModal(`
                            <p class="text-lg font-semibold mb-4">éœ€è¦åŒæ„ï¼</p>
                            <p class="text-gray-700 mb-6">è¯·å‹¾é€‰æ–¹æ¡†ä»¥åŒæ„æ¡æ¬¾ã€åŒæ„ä¹¦å’Œä¿å¯†åè®®ï¼Œç„¶åç»§ç»­ã€‚</p>
                            <button class="btn-primary" onclick="closeCustomModal()">æ˜ç™½äº†</button>
                        `);
                        consentCheckboxFinal.focus();
                        return;
                    }

                    const senderEmail = senderEmailInput.value.trim();
                    if (!senderEmail) {
                        showCustomModal(`
                            <p class="text-lg font-semibold mb-4">å“å‘€ï¼æ‚¨çš„é‚®ç®±ç¼ºå¤±</p>
                            <p class="text-gray-700 mb-6">è¯·è¾“å…¥æ‚¨çš„ç”µå­é‚®ç®±åœ°å€ä»¥ç»§ç»­ã€‚</p>
                            <button class="btn-primary" onclick="closeCustomModal()">æ˜ç™½äº†</button>
                        `);
                        return;
                    }
                    if (!isValidEmail(senderEmail)) {
                        showCustomModal(`
                            <p class="text-lg font-semibold mb-4">æ— æ•ˆçš„é‚®ç®±æ ¼å¼</p>
                            <p class="text-gray-700 mb-6">è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€ï¼ˆä¾‹å¦‚ï¼šæ‚¨çš„é‚®ç®±@example.comï¼‰ä»¥ç»§ç»­ã€‚</p>
                            <button class="btn-primary" onclick="closeCustomModal()">æ˜ç™½äº†</p>
                        `);
                        return;
                    }

                    const acknowledgedName = fullNameInput.value.trim();
                    if (!acknowledgedName) {
                        showCustomModal(`
                            <p class="text-lg font-semibold mb-4">è¯·ç¡®è®¤ï¼</p>
                            <p class="text-gray-700 mb-6">è¯·åœ¨ç¡®è®¤éƒ¨åˆ†è¾“å…¥æ‚¨çš„å…¨åä»¥ç¡®è®¤æ‚¨çš„åŒæ„ã€‚</p>
                            <button class="btn-primary" onclick="closeCustomModal()">æ˜ç™½äº†</button>
                        `);
                        fullNameInput.focus();
                        return;
                    }

                    // Collect all answers
                    const emailBody = collectAnswersForMailto();
                    const subject = encodeURIComponent('æˆ‘æ¥è‡ªAvneetçš„å…³ç³»é—®å·ç­”æ¡ˆ');

                    // Construct mailto link
                    const mailtoLink = `mailto:${RECIPIENT_EMAIL}?subject=${subject}&body=${emailBody}`;

                    // Open email client
                    window.location.href = mailtoLink;

                    // Provide a confirmation to the user
                    showCustomModal(`
                        <p class="text-lg font-semibold mb-4">æ­£åœ¨æ‰“å¼€æ‚¨çš„ç”µå­é‚®ä»¶åº”ç”¨ç¨‹åº...</p>
                        <p class="text-gray-700 mb-6">ä¸€ä¸ªåŒ…å«æ‚¨ç­”æ¡ˆçš„æ–°ç”µå­é‚®ä»¶è‰ç¨¿åº”è¯¥å¾ˆå¿«æ‰“å¼€ã€‚è¯·ç¡®ä¿åœ¨æ‚¨çš„ç”µå­é‚®ä»¶åº”ç”¨ç¨‹åºä¸­ç‚¹å‡»â€œå‘é€â€ä»¥å®Œæˆæäº¤ã€‚</p>
                        <button class="btn-primary" onclick="closeCustomModal()">å¥½çš„</button>
                    `);

                    // Optionally, reset form after attempting to open mailto
                    // loveQuizForm.reset();
                    // document.querySelectorAll('textarea').forEach(textarea => { setInitialAnswer(textarea); });
                    // consentCheckboxFinal.checked = false;
                    // signatureBox.classList.add('hidden');
                    // displayedSignature.textContent = '';
                });
            }
        });
        
        // Ensure the PDF download button still works as intended (no changes needed for this)
    </script>
</body>
</html>
